---
title: "p8105_hw2_rl3411"
author: "rl3411"
date: "`r Sys.Date()`"
output: github_document
---

```{r, message = F}
library(tidyverse)
library(readxl)
```

# Problem 1

Let's first load and clean the `pols-month.csv` dataset.
```{r, message = F}
pols_df <- 
  read_csv("data/pols-month.csv") |> 
  separate(mon, into = c("year", "month", "day"), sep = "-") |> 
  mutate(
    month = month.name[as.numeric(month)],
    year = as.integer(year),
    president = case_when(
      (prez_gop == 1 | prez_gop == 2) ~ "gop",
      (prez_dem == 1) ~ "dem"
    ) 
  ) |> 
  select(-c(prez_gop, prez_dem, day))
```

Now, let's load and clean the `snp.csv` dataset.

```{r, message = F}
snp_df <- 
  read_csv("data/snp.csv") |> 
  separate(date, into = c("month", "day", "year"), sep = "/") |> 
  select(year, month, close) |> 
  mutate(
    month = month.name[as.numeric(month)],
    year = case_when(
      year < 23 ~ as.integer(paste0("20", year)),
      year > 23 ~ as.integer(paste0("19", year))
      )
    )
```

We now clean `unemployment.csv`.

```{r, message = F}
uepm_df <- 
  read_csv("data/unemployment.csv") |> 
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "unemployment"
  ) |> 
  mutate(
    month = month.name[match(month,month.abb)]
    ) |> 
  rename(year = Year)
```

Merging datasets together.

```{r}
combined_df <- 
  left_join(pols_df, snp_df, by = join_by("year", "month")) |> 
  left_join(uepm_df, by = join_by("year", "month"))
```


Description:

The `pols_df` dataset contains 822 observations (i.e. rows) and 9 variables (i.e. columns). It shows the number of republican and democratic governors, senators and representatives, as well as whether the president was republican or democratic from January 1947 to June 2015.

The `snp_df` dataset contains 787 observations (i.e. rows) and 3 variables (i.e. columns). It shows the Standard and Poor's stock market index closing values from January 1950 to July 2015. As we are joining `snp_df` *into* `pols_df`, we take the dimension of `pols_df` and hence miss out the S&P closing price on July 2015.

The `uepm_df` dataset contains from January 1948 to June 2015

Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

# Problem 2

```{r}
mr_tw <- 
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Mr. Trash Wheel",
             range = "B2:N586") |> 
  janitor::clean_names() |> 
  separate(date, into = c("year", "month", "day"), sep = "-") |> 
  mutate(
    month = month.name[as.numeric(month)],
    homes_powered = weight_tons * 500/30,
    dumpster = "Mr. Trash Wheel"
    ) 

prof_tw <- 
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Professor Trash Wheel",
             range = "B2:M108") |> 
  janitor::clean_names() |> 
  separate(date, into = c("year", "month", "day"), sep = "-") |> 
  mutate(
    month = month.name[as.numeric(month)],
    homes_powered = weight_tons * 500/30,
    dumpster = "Professor Trash Wheel"
    ) 

gwynnda_tw <- 
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Gwynnda Trash Wheel",
             range = "B2:L157") |> 
  janitor::clean_names() |> 
  separate(date, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    month = month.name[as.numeric(month)],
    homes_powered = weight_tons * 500/30,
    dumpster = "Gwynnda Trash Wheel"
  ) 

# Combine data
dumpster_df <- 
  bind_rows(mr_tw, prof_tw) |> 
  bind_rows(gwynnda_tw)

head(dumpster_df)
```

homes_powered






